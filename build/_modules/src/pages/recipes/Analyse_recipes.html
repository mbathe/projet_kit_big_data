

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.pages.recipes.Analyse_recipes &mdash; Documentation bgdia700 1.0</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=7a28dfa3"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            bgdia700
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../pages/recettes.html">Recettes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pages/nutrition.html">Nutrition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pages/analyse_user.html">Analyse Utilisateur</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pages/recipes/Welcom.html">Welcom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pages/recipes/Analyse_recipe.html">Analyse Recipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../process.html">Processus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../visualizations.html">Visualisations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">bgdia700</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Code du module</a></li>
      <li class="breadcrumb-item active">src.pages.recipes.Analyse_recipes</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Code source de src.pages.recipes.Analyse_recipes</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">src.process.recipes</span> <span class="kn">import</span> <span class="n">Recipe</span>
<span class="kn">from</span> <span class="nn">src.utils.static</span> <span class="kn">import</span> <span class="n">mois</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">from</span> <span class="nn">src.visualizations</span> <span class="kn">import</span> <span class="n">load_css</span>
<span class="kn">from</span> <span class="nn">src.utils.static</span> <span class="kn">import</span> <span class="n">recipe_columns_description</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">streamlit_echarts</span> <span class="kn">import</span> <span class="n">st_echarts</span>
<span class="kn">from</span> <span class="nn">src.utils.static</span> <span class="kn">import</span> <span class="n">constribution_data</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">src.process.recommandation</span> <span class="kn">import</span> <span class="n">AdvancedRecipeRecommender</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>


<span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s2">&quot;Recipes Explorer&quot;</span><span class="p">,</span>
    <span class="n">page_icon</span><span class="o">=</span><span class="s2">&quot;üç≥&quot;</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;wide&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../../..&#39;</span><span class="p">),</span> <span class="s2">&quot;app.log&quot;</span><span class="p">)),</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">error_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../../..&#39;</span><span class="p">),</span> <span class="s2">&quot;error.log&quot;</span><span class="p">))</span>
<span class="n">error_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">error_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
    <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">error_handler</span><span class="p">)</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="s1">&#39;fr_FR.UTF-8&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">locale</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span>
    <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">DEPLOIEMENT_SITE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DEPLOIEMENT_SITE&quot;</span><span class="p">)</span>
<span class="n">YEAR_MIN</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1999</span> <span class="k">if</span> <span class="n">DEPLOIEMENT_SITE</span> <span class="o">!=</span> <span class="s2">&quot;ONLINE&quot;</span> <span class="k">else</span> <span class="mi">2014</span>
<span class="n">YEAR_MAX</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2018</span> <span class="k">if</span> <span class="n">DEPLOIEMENT_SITE</span> <span class="o">!=</span> <span class="s2">&quot;ONLINE&quot;</span> <span class="k">else</span> <span class="mi">2018</span>


<div class="viewcode-block" id="CSSLoader">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.CSSLoader">[docs]</a>
<span class="k">class</span> <span class="nc">CSSLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classe responsable du chargement des CSS.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="CSSLoader.load">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.CSSLoader.load">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">css_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Charge un fichier CSS.</span>

<span class="sd">        Args:</span>
<span class="sd">            css_file (str): Le chemin vers le fichier CSS.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si le chargement du fichier CSS √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">load_css</span><span class="p">(</span><span class="n">css_file</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CSS charg√© depuis </span><span class="si">{</span><span class="n">css_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;√âchec du chargement du CSS depuis </span><span class="si">{</span><span class="n">css_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load CSS: CSS load error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="DataManager">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager">[docs]</a>
<span class="k">class</span> <span class="nc">DataManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classe responsable du chargement et de traitement des donn√©es.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise le DataManager avec une instance de Recipe.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="p">:</span> <span class="n">Recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">()</span>

<div class="viewcode-block" id="DataManager.set_date_range">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.set_date_range">[docs]</a>
    <span class="k">def</span> <span class="nf">set_date_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_date</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">:</span> <span class="n">date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        D√©finit la plage de dates pour les donn√©es de recettes.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_date (date): La date de d√©but.</span>
<span class="sd">            end_date (date): La date de fin.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si la d√©finition de la plage de dates √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">(</span><span class="n">date_start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plage de dates d√©finie de </span><span class="si">{</span>
<span class="w">                         </span><span class="n">start_date</span><span class="si">}</span><span class="s2"> √† </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;√âchec de la d√©finition de la plage de dates: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataManager.get_recipe_data">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.get_recipe_data">[docs]</a>
    <span class="k">def</span> <span class="nf">get_recipe_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Recipe</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Obtient les donn√©es de recettes.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            Recipe: Les donn√©es de recettes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span></div>


<div class="viewcode-block" id="DataManager.export_data">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.export_data">[docs]</a>
    <span class="k">def</span> <span class="nf">export_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">export_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exporte les donn√©es de recettes dans le format sp√©cifi√©.</span>

<span class="sd">        Args:</span>
<span class="sd">            export_format (str): Le format dans lequel exporter les donn√©es (&quot;CSV&quot; ou &quot;JSON&quot;).</span>

<span class="sd">        Retourne:</span>
<span class="sd">            str: Les donn√©es export√©es sous forme de cha√Æne de caract√®res.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si l&#39;exportation des donn√©es √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">export_format</span> <span class="o">==</span> <span class="s2">&quot;CSV&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">export_format</span> <span class="o">==</span> <span class="s2">&quot;JSON&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;√âchec de l&#39;exportation des donn√©es: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataManager.analyze_temporal_distribution">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.analyze_temporal_distribution">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze_temporal_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyse la distribution temporelle des recettes.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_datetime (datetime): La date et l&#39;heure de d√©but.</span>
<span class="sd">            end_datetime (datetime): La date et l&#39;heure de fin.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            dict: Les r√©sultats de l&#39;analyse.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si l&#39;analyse de la distribution temporelle √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">analyze_temporal_distribution</span><span class="p">(</span><span class="n">start_datetime</span><span class="p">,</span> <span class="n">end_datetime</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;√âchec de l&#39;analyse de la distribution temporelle: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataManager.analyze_recipe_complexity">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.analyze_recipe_complexity">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze_recipe_complexity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyse la complexit√© des recettes.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            dict: Les r√©sultats de l&#39;analyse.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si l&#39;analyse de la complexit√© des recettes √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">analyze_recipe_complexity</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;√âchec de l&#39;analyse de la complexit√© des recettes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataManager.analyze_nutrition">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.analyze_nutrition">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze_nutrition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyse les informations nutritionnelles des recettes.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            dict: Les r√©sultats de l&#39;analyse.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si l&#39;analyse des informations nutritionnelles √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">analyze_nutrition</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;√âchec de l&#39;analyse des informations nutritionnelles: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataManager.analyze_tags">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DataManager.analyze_tags">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyse les tags des recettes.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            dict: Les r√©sultats de l&#39;analyse.</span>

<span class="sd">        L√®ve:</span>
<span class="sd">            Exception: Si l&#39;analyse des tags √©choue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">analyze_tags</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;√âchec de l&#39;analyse des tags: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DisplayManager">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager">[docs]</a>
<span class="k">class</span> <span class="nc">DisplayManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Classe responsable de l&#39;afficharge de la page Recettes. elle permet de visualiser :</span>
<span class="sd">    -Statistiques nutritionnelles d√©taill√©es</span>
<span class="sd">    - Visualisation des tendances culinaires</span>
<span class="sd">    - Analyse comparative des ingr√©dients</span>
<span class="sd">    - Syst√®me de recommandation personnalis√© bas√© sur les pr√©f√©rences</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_manager</span><span class="p">:</span> <span class="n">DataManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise le DisplayManager avec une instance de DataManager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="p">:</span> <span class="n">DataManager</span> <span class="o">=</span> <span class="n">data_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recommender</span><span class="p">:</span>  <span class="n">AdvancedRecipeRecommender</span> <span class="o">=</span> <span class="n">AdvancedRecipeRecommender</span><span class="p">(</span>
            <span class="n">recipes_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<div class="viewcode-block" id="DisplayManager.load_css">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.load_css">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_css</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Charge les fichiers CSS pour l&#39;application.&quot;&quot;&quot;</span>
        <span class="n">path_to_css_user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;src/css_pages/analyse_user.css&#39;</span>
        <span class="n">path_to_css_recipe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;src/css_pages/recipe.css&#39;</span>
        <span class="n">CSSLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_to_css_user</span><span class="p">)</span>
        <span class="n">CSSLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_to_css_recipe</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.sidebar">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.sidebar">[docs]</a>
    <span class="k">def</span> <span class="nf">sidebar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays the sidebar with configuration options.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        None</span>

<span class="sd">        Returns:</span>
<span class="sd">        None</span>

<span class="sd">        Raises:</span>
<span class="sd">        Exception: If any error occurs during the execution of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;‚öôÔ∏è Configuration&quot;</span><span class="p">)</span>
                <span class="n">date_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">date_input</span><span class="p">(</span>
                    <span class="s2">&quot;P√©riode d&#39;analyse&quot;</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="n">YEAR_MIN</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="n">YEAR_MAX</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)),</span>
                    <span class="n">key</span><span class="o">=</span><span class="s1">&#39;date_filter&#39;</span><span class="p">,</span>
                    <span class="n">min_value</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="n">YEAR_MIN</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">max_value</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="n">YEAR_MAX</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&quot;Charger les donn√©es&quot;</span><span class="p">):</span>
                    <span class="n">start_date</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">date_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">end_date</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">date_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;La date de d√©but doit √™tre ant√©rieure ou √©gale √† la date de fin.&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">set_date_range</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P√©riode d&#39;analyse: </span><span class="si">{</span>
<span class="w">                                   </span><span class="n">start_date</span><span class="si">}</span><span class="s2"> √† </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">show_toggle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">toggle</span><span class="p">(</span>
                    <span class="s2">&quot;Utiliser les donn√©es nettoy√©es&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_toggle</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">clean_dataframe</span><span class="p">()</span>
                <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;üì• Exporter&quot;</span><span class="p">)</span>
                <span class="n">export_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
                    <span class="s2">&quot;Format d&#39;export&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;CSV&quot;</span><span class="p">,</span> <span class="s2">&quot;JSON&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">export_format</span> <span class="o">==</span> <span class="s2">&quot;CSV&quot;</span><span class="p">:</span>
                    <span class="n">csv</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">export_data</span><span class="p">(</span><span class="s2">&quot;CSV&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;T√©l√©charger au format CSV&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">csv</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;text/csv&quot;</span><span class="p">):</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;Export en cours...&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">export_format</span> <span class="o">==</span> <span class="s2">&quot;JSON&quot;</span><span class="p">:</span>
                    <span class="n">json</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">export_data</span><span class="p">(</span><span class="s2">&quot;JSON&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">download_button</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;T√©l√©charger au format JSON&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;data.json&quot;</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span><span class="p">):</span>
                        <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;Export en cours...&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans sidebar: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.home_tab">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.home_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">home_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Affiche l&#39;onglet d&#39;accueil avec l&#39;analyse des recettes.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;üè† Analyse de Recettes&quot;</span><span class="p">)</span>
            <span class="n">columns_to_show</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;submitted&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;nutrition&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients&quot;</span><span class="p">]</span>
            <span class="n">coll</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns_to_show</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">annomalis</span><span class="p">[</span><span class="s2">&quot;column_info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">columns_to_show</span><span class="p">:</span>
                    <span class="k">with</span> <span class="n">coll</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="s2">&quot;submitted&quot;</span><span class="p">:</span>
                            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                            &lt;div class=&quot;metric-container&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-label&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-label&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Unique Count&quot;</span><span class="p">]))</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-value&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Unique Percentage&#39;</span><span class="p">]))</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                            &lt;/div&gt;</span>
<span class="s2">                            &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                            &lt;div class=&quot;metric-container&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-label&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-label&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Unique Count&quot;</span><span class="p">]))</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">                                &lt;div class=&quot;metric-value&quot;&gt;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Unique Percentage&#39;</span><span class="p">]))</span><span class="si">}</span><span class="s2">%&lt;/div&gt;</span>
<span class="s2">                            &lt;/div&gt;</span>
<span class="s2">                            &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">option</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;S√©lectionnez une page&quot;</span><span class="p">,</span> <span class="p">[</span>
                <span class="s2">&quot;Description du dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;Colonne Ingredient&quot;</span><span class="p">,</span> <span class="s2">&quot;Colonne Description&quot;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;selectbox_accueil&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;Description du dataset&quot;</span><span class="p">:</span>
                <span class="n">columns_to_show</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span>
                    <span class="s2">&quot;S√©lectionner les colonnes √† afficher&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;ingredients&quot;</span><span class="p">,</span> <span class="s2">&quot;steps&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;minutes&quot;</span><span class="p">,</span> <span class="s2">&quot;submitted&quot;</span><span class="p">,</span> <span class="s2">&quot;n_steps&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;n_ingredients&quot;</span><span class="p">],</span>
                    <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;submitted&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">search_term</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span>
                    <span class="s2">&quot;üîç Rechercher dans le dataset&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_data_structures</span><span class="p">(</span>
                    <span class="n">columns_to_show</span><span class="o">=</span><span class="n">columns_to_show</span><span class="p">,</span> <span class="n">search_term</span><span class="o">=</span><span class="n">search_term</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_anomalies_values</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;Colonne Ingredient&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analyze_ingredients</span><span class="p">()</span>
                <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Filtres Ingr√©dients&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;Colonne Description&quot;</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Page d&#39;analyse&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;√âtude de la colonne Description&quot;</span><span class="p">)</span>
                <span class="n">show_sentiment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">toggle</span><span class="p">(</span>
                    <span class="s2">&quot;Afficher l&#39;analyse de sentiment&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_sentiment</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span>
                        <span class="s2">&quot;Sentiment positif d√©tect√© dans 75</span><span class="si">% d</span><span class="s2">es descriptions&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans home_tab: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.analysis_tab">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.analysis_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">analysis_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Affiche l&#39;onglet d&#39;analyse avec diverses options d&#39;analyse.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">option_analyse</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;S√©lectionnez une page&quot;</span><span class="p">,</span> <span class="p">[</span>
                <span class="s2">&quot;Distribution des soumissions&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Analyse des √âtapes et du Temps&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Analyse les informations nutritionnelles&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Analyse les tags des recettes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Analyse les contributions par utilisateur&quot;</span>
            <span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;selectbox_analyse_11&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">option_analyse</span> <span class="o">==</span> <span class="s2">&quot;Distribution des soumissions&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_submission_analysis</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">option_analyse</span> <span class="o">==</span> <span class="s2">&quot;Analyse des √âtapes et du Temps&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_steps_and_time_analysis</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">option_analyse</span> <span class="o">==</span> <span class="s2">&quot;Analyse les informations nutritionnelles&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_nutrition_analysis</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">option_analyse</span> <span class="o">==</span> <span class="s2">&quot;Analyse les tags des recettes&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_tags_analysis</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">option_analyse</span> <span class="o">==</span> <span class="s2">&quot;Analyse les contributions par utilisateur&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_contributors_analysis</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans analysis_tab: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_contributors_analysis">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_contributors_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">display_contributors_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche une analyse compl√®te des contributeurs avec des visualisations interactives.</span>

<span class="sd">        Fournit des m√©triques, des graphiques de distribution et des informations d√©taill√©es sur les contributeurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">constribution_data</span>

            <span class="n">top_contrib_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;top_contributors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ID Utilisateur&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;‚öôÔ∏è Param√®tres&quot;</span><span class="p">)</span>
            <span class="n">display_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
                <span class="s2">&quot;Mode d&#39;affichage&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Vue d&#39;ensemble&quot;</span><span class="p">,</span> <span class="s2">&quot;Analyse d√©taill√©e&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">color_theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
                <span class="s2">&quot;Th√®me de couleur&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;blues&quot;</span><span class="p">,</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="s2">&quot;plasma&quot;</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;üìä Analyse des Contributions&quot;</span><span class="p">)</span>
            <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Total Contributeurs&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_contributors&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">delta</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                <span class="n">contribution_mean</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
                <span class="n">contribution_median</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">]</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Moyenne Contributions&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contribution_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">delta</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="p">((</span><span class="n">contribution_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">contribution_median</span><span class="p">)</span><span class="w"> </span><span class="o">/</span>
<span class="w">                               </span><span class="n">contribution_median</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;M√©diane Contributions&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contribution_median</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col4</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Max Contributions&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">display_mode</span> <span class="o">==</span> <span class="s2">&quot;Vue d&#39;ensemble&quot;</span><span class="p">:</span>
                <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution des Contributions&quot;</span><span class="p">)</span>
                    <span class="n">fig_dist</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_distribution_figure</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_dist</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Top 10 Contributeurs&quot;</span><span class="p">)</span>
                    <span class="n">fig_top</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_top_contributors_figure</span><span class="p">(</span>
                        <span class="n">top_contrib_df</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_top</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">tab1</span><span class="p">,</span> <span class="n">tab2</span><span class="p">,</span> <span class="n">tab3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">tabs</span><span class="p">(</span>
                    <span class="p">[</span><span class="s2">&quot;üìä Distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;üèÜ Top Contributeurs&quot;</span><span class="p">,</span> <span class="s2">&quot;üìà Analyse comparative&quot;</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">with</span> <span class="n">tab1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_display_distribution_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">tab2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_display_top_contributors</span><span class="p">(</span><span class="n">top_contrib_df</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">tab3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_display_comparative_analysis</span><span class="p">(</span><span class="n">top_contrib_df</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&quot;‚ÑπÔ∏è Notes et explications&quot;</span><span class="p">):</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                ### Guide d&#39;utilisation</span>
<span class="s2">                1. Utilisez la barre lat√©rale pour changer le mode d&#39;affichage et le th√®me de couleur</span>
<span class="s2">                2. Dans la vue d√©taill√©e :</span>
<span class="s2">                    - L&#39;onglet Distribution montre la r√©partition des contributions</span>
<span class="s2">                    - L&#39;onglet Top Contributeurs permet d&#39;explorer les meilleurs contributeurs</span>
<span class="s2">                    - L&#39;onglet Analyse comparative pr√©sente une vue multidimensionnelle</span>
<span class="s2">                3. Interagissez avec les graphiques :</span>
<span class="s2">                    - Zoom</span>
<span class="s2">                    - S√©lection</span>
<span class="s2">                    - Survol pour plus de d√©tails</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;*Donn√©es mises √† jour le </span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">*&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans display_contributors_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_create_distribution_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cr√©e une figure montrant les statistiques de distribution des contributions.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict): Les donn√©es contenant les statistiques de contribution.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            go.Figure: La figure cr√©√©e.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fig_dist</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
            <span class="n">fig_dist</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Statistiques&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Moyenne&#39;</span><span class="p">,</span> <span class="s1">&#39;M√©diane&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">],</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                <span class="p">],</span>
                <span class="n">text</span><span class="o">=</span><span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">],</span>
                <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">marker_color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#36A2EB&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF6384&#39;</span><span class="p">,</span> <span class="s1">&#39;#4BC0C0&#39;</span><span class="p">]</span>
            <span class="p">))</span>
            <span class="n">fig_dist</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig_dist</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans _create_distribution_figure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_top_contributors_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_contrib_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cr√©e une figure montrant les principaux contributeurs.</span>

<span class="sd">        Args:</span>
<span class="sd">            top_contrib_df (pd.DataFrame): Le DataFrame contenant les principaux contributeurs.</span>
<span class="sd">            color_theme (str): Le th√®me de couleur pour la figure.</span>

<span class="sd">        Retourne:</span>
<span class="sd">            px.bar: La figure cr√©√©e.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fig_top</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                <span class="n">top_contrib_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;ID Utilisateur&#39;</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">,</span>
                <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">color_theme</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">fig_top</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{y}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
            <span class="n">fig_top</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig_top</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans _create_top_contributors_figure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_display_distribution_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche un histogramme de la distribution des contributions.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict): Les donn√©es contenant les statistiques de contribution.</span>
<span class="sd">            color_theme (str): Le th√®me de couleur pour la figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution d√©taill√©e des contributions&quot;</span><span class="p">)</span>
            <span class="n">simulated_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_contributors&#39;</span><span class="p">])</span>
            <span class="n">simulated_data</span> <span class="o">*=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">]</span>
                               <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">simulated_data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

            <span class="n">fig_hist</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
                <span class="n">simulated_data</span><span class="p">,</span>
                <span class="n">nbins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribution des contributions (simulation)&quot;</span><span class="p">,</span>
                <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="p">[</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">sequential</span><span class="o">.</span><span class="n">Blues</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span>
            <span class="p">)</span>
            <span class="n">fig_hist</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
                <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Nombre de contributions&quot;</span><span class="p">,</span>
                <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Fr√©quence&quot;</span>
            <span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_hist</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans _display_distribution_histogram: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_display_top_contributors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_contrib_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">color_theme</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche les principaux contributeurs avec un treemap et un tableau d√©taill√©.</span>

<span class="sd">        Args:</span>
<span class="sd">            top_contrib_df (pd.DataFrame): Le DataFrame contenant les principaux contributeurs.</span>
<span class="sd">            color_theme (str): Le th√®me de couleur pour la figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Analyse des principaux contributeurs&quot;</span><span class="p">)</span>
            <span class="n">n_contributors</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">slider</span><span class="p">(</span>
                <span class="s2">&quot;Nombre de contributeurs √† afficher&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
            <span class="n">fig_treemap</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">treemap</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">treemap</span><span class="p">(</span>
                <span class="n">top_contrib_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_contributors</span><span class="p">),</span>
                <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ID Utilisateur&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Top </span><span class="si">{</span><span class="n">n_contributors</span><span class="si">}</span><span class="s2"> contributeurs (Treemap)&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">,</span>
                <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">color_theme</span>
            <span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_treemap</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span>
                <span class="n">top_contrib_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_contributors</span><span class="p">)</span><span class="o">.</span><span class="n">style</span>
                <span class="o">.</span><span class="n">format</span><span class="p">({</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:,.0f}</span><span class="s1">&#39;</span><span class="p">}),</span>
                <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans _display_top_contributors: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_display_comparative_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_contrib_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche un graphique radar comparatif pour les principaux contributeurs.</span>

<span class="sd">        Args:</span>
<span class="sd">            top_contrib_df (pd.DataFrame): Le DataFrame contenant les principaux contributeurs.</span>
<span class="sd">            data (dict): Les donn√©es contenant les statistiques de contribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Analyse comparative&quot;</span><span class="p">)</span>
            <span class="n">categories</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Contributions&#39;</span><span class="p">,</span> <span class="s1">&#39;R√©gularit√©&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Impact&#39;</span><span class="p">,</span> <span class="s1">&#39;Engagement&#39;</span><span class="p">,</span> <span class="s1">&#39;Qualit√©&#39;</span><span class="p">]</span>
            <span class="n">top_3_contributors</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">top_contrib_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">fig_radar</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">top_3_contributors</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Nombre de contributions&#39;</span><span class="p">]</span> <span class="o">/</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;contributions_per_user&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">categories_closed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories</span> <span class="o">+</span> <span class="p">[</span><span class="n">categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">fig_radar</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
                    <span class="n">r</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">theta</span><span class="o">=</span><span class="n">categories_closed</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ID Utilisateur&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">))</span>
            <span class="n">fig_radar</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
                <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">radialaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                        <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_radar</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans _display_comparative_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DisplayManager.display_tags_analysis">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_tags_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">display_tags_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche une analyse d√©taill√©e des tags de recettes.</span>
<span class="sd">        Cette m√©thode g√©n√®re plusieurs visualisations et statistiques</span>
<span class="sd">        sur l&#39;utilisation des tags dans le jeu de donn√©es de recettes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tags_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">analyze_tags</span><span class="p">()</span>
            <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;üìä Analyse des Tags de Recettes&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;üìà Statistiques Globales&quot;</span><span class="p">)</span>
            <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Nombre total de tags uniques&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;total_unique_tags&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Moyenne de tags par recette&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;M√©diane de tags par recette&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="n">col4</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span>
                    <span class="s2">&quot;Maximum de tags par recette&quot;</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="n">tab1</span><span class="p">,</span> <span class="n">tab2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">tabs</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;üè∑Ô∏è Tags les Plus Courants&quot;</span><span class="p">,</span> <span class="s2">&quot;üìä Analyse D√©taill√©e&quot;</span><span class="p">])</span>

            <span class="k">with</span> <span class="n">tab1</span><span class="p">:</span>
                <span class="n">df_tags</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;most_common_tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">total_tags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">df_tags</span><span class="p">[</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="n">df_tags</span><span class="p">[</span><span class="s1">&#39;Pourcentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df_tags</span><span class="p">[</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_tags</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">fig_bars</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                    <span class="n">df_tags</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span>
                    <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Tags les Plus Courants&#39;</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Pourcentage&#39;</span>
                <span class="p">)</span>

                <span class="n">fig_bars</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
                    <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text:.1f}</span><span class="s1">%&#39;</span><span class="p">,</span>
                    <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>
                <span class="p">)</span>
                <span class="n">fig_bars</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_bars</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span><span class="s2">&quot;Voir les donn√©es d√©taill√©es des tags&quot;</span><span class="p">):</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span>
                        <span class="n">df_tags</span><span class="o">.</span><span class="n">style</span>
                        <span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span>
                        <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>

            <span class="k">with</span> <span class="n">tab2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution des Tags&quot;</span><span class="p">)</span>
                <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                    <span class="n">top_5_tags</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">df_tags</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                    <span class="n">fig_pie</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span>
                        <span class="n">top_5_tags</span><span class="p">,</span>
                        <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">,</span>
                        <span class="n">names</span><span class="o">=</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Top 5 des Tags les Plus Utilis√©s&#39;</span>
                    <span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_pie</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                    <span class="n">fig_treemap</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">treemap</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">treemap</span><span class="p">(</span>
                        <span class="n">df_tags</span><span class="p">,</span>
                        <span class="n">path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Tag&#39;</span><span class="p">],</span>
                        <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">utilisations&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Visualisation Hi√©rarchique des Tags&#39;</span>
                    <span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_treemap</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Analyses des Cat√©gories de Tags&quot;</span><span class="p">)</span>
                <span class="n">categories</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;Temps de pr√©paration&#39;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s1">&#39;time-to-make&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;60-minutes-or-less&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;30-minutes-or-less&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;4-hours-or-less&#39;</span>
                    <span class="p">],</span>
                    <span class="s1">&#39;Type de plat&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;course&#39;</span><span class="p">,</span> <span class="s1">&#39;main-dish&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Ingr√©dients&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;main-ingredient&#39;</span><span class="p">,</span> <span class="s1">&#39;meat&#39;</span><span class="p">,</span> <span class="s1">&#39;vegetables&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Caract√©ristiques&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;dietary&#39;</span><span class="p">,</span> <span class="s1">&#39;easy&#39;</span><span class="p">,</span> <span class="s1">&#39;low-in-something&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;Cuisine&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cuisine&#39;</span><span class="p">,</span> <span class="s1">&#39;north-american&#39;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="n">category_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s1">&#39;Cat√©gorie&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
                        <span class="s1">&#39;Total&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;most_common_tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">tags</span> <span class="ow">in</span> <span class="n">categories</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">]</span>
                <span class="n">df_categories</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">category_data</span><span class="p">)</span>
                <span class="n">fig_categories</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                    <span class="n">df_categories</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Cat√©gorie&#39;</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution par Cat√©gorie de Tags&#39;</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span>
                <span class="p">)</span>

                <span class="n">fig_categories</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
                    <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text:,}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>
                <span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_categories</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;üìä Distribution des Tags par Recette&quot;</span><span class="p">)</span>
                <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                    <span class="n">x_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                        <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                        <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
                        <span class="mi">100</span>
                    <span class="p">)</span>
                    <span class="n">fig_dist</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
                    <span class="n">fig_dist</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                            <span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">-</span>
                                       <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">50</span><span class="p">),</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Distribution estim√©e&#39;</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">fig_dist</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution Estim√©e du Nombre de Tags par Recette&#39;</span><span class="p">,</span>
                        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Nombre de Tags&#39;</span><span class="p">,</span>
                        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Densit√© relative&#39;</span>
                    <span class="p">)</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_dist</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Statistiques D√©taill√©es&quot;</span><span class="p">)</span>
                    <span class="n">stats_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                        <span class="s1">&#39;Statistique&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">,</span> <span class="s1">&#39;Moyenne&#39;</span><span class="p">,</span> <span class="s1">&#39;M√©diane&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;Valeur&#39;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                            <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
                            <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span>
                            <span class="n">tags_data</span><span class="p">[</span><span class="s1">&#39;tags_per_recipe&#39;</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">]</span>
                        <span class="p">]</span>
                    <span class="p">})</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span>
                        <span class="n">stats_df</span><span class="o">.</span><span class="n">style</span>
                        <span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Valeur&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Valeur&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span>
                        <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur dans display_tags_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_submission_analysis">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_submission_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">display_submission_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Afficher l&#39;analyse des soumissions de recettes au fil du temps.</span>

<span class="sd">        Cette fonction permet de cr√©er un tableau de bord interactif pour visualiser la distribution</span>
<span class="sd">        des recettes soumises en fonction des ann√©es, des mois et des jours de la semaine. Elle permet aux</span>
<span class="sd">        de s√©lectionner une plage de dates pour l&#39;analyse et pr√©sente les donn√©es √† l&#39;aide de divers</span>
<span class="sd">        graphiques et tableaux.</span>

<span class="sd">        L&#39;analyse comprend</span>
<span class="sd">        - Tendances annuelles des soumissions</span>
<span class="sd">        - La r√©partition mensuelle des demandes</span>
<span class="sd">        - les sch√©mas de soumission pour les jours de la semaine.</span>

<span class="sd">        La fonction traite les exceptions potentielles et enregistre toutes les erreurs qui se produisent pendant l&#39;ex√©cution.</span>

<span class="sd">        Param√®tres :</span>
<span class="sd">        Aucun</span>

<span class="sd">        Retourne :</span>
<span class="sd">        Aucun.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;üìä Analyse des Soumissions&quot;</span><span class="p">)</span>
            <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                <span class="n">start_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">slider</span><span class="p">(</span>
                    <span class="s2">&quot;Ann√©e de d√©but&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">date_start</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">date_end</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">date_start</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                <span class="n">end_year</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">slider</span><span class="p">(</span><span class="s2">&quot;Ann√©e de fin&quot;</span><span class="p">,</span> <span class="n">YEAR_MIN</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">date_end</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">date_end</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="n">date_start</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">date_end</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
            <span class="n">start_datetime</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date_start</span><span class="p">)</span>
            <span class="n">end_datetime</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date_end</span><span class="p">)</span>
            <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">analyze_temporal_distribution</span><span class="p">(</span>
                <span class="n">start_datetime</span><span class="p">,</span> <span class="n">end_datetime</span><span class="p">)</span>
            <span class="n">submissions_per_year</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;submissions_per_year&quot;</span><span class="p">)</span>
            <span class="n">submissions_per_month</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;submissions_per_month&quot;</span><span class="p">)</span>
            <span class="n">submissions_per_weekday</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;submissions_per_weekday&quot;</span><span class="p">)</span>

            <span class="n">df_year</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">submissions_per_year</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                <span class="s1">&#39;Ann√©e&#39;</span><span class="p">,</span> <span class="s1">&#39;Soumissions&#39;</span><span class="p">])</span>
            <span class="n">df_month</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">submissions_per_month</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                <span class="s1">&#39;Mois&#39;</span><span class="p">,</span> <span class="s1">&#39;Soumissions&#39;</span><span class="p">])</span>
            <span class="n">df_weekday</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">submissions_per_weekday</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                <span class="s1">&#39;Jour&#39;</span><span class="p">,</span> <span class="s1">&#39;Soumissions&#39;</span><span class="p">])</span>

            <span class="n">jours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lundi&#39;</span><span class="p">,</span> <span class="s1">&#39;Mardi&#39;</span><span class="p">,</span> <span class="s1">&#39;Mercredi&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;Jeudi&#39;</span><span class="p">,</span> <span class="s1">&#39;Vendredi&#39;</span><span class="p">,</span> <span class="s1">&#39;Samedi&#39;</span><span class="p">,</span> <span class="s1">&#39;Dimanche&#39;</span><span class="p">]</span>
            <span class="n">df_weekday</span><span class="p">[</span><span class="s1">&#39;Nom du Jour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_weekday</span><span class="p">[</span><span class="s1">&#39;Jour&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jours</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

            <span class="n">df_month</span><span class="p">[</span><span class="s1">&#39;Nom du Mois&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_month</span><span class="p">[</span><span class="s1">&#39;Mois&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mois</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

            <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;üìÖ P√©riode d&#39;analyse&quot;</span><span class="p">)</span>
            <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Date de d√©but&quot;</span><span class="p">,</span> <span class="n">date_start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-d</span><span class="s2"> %B %Y&quot;</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Date de fin&quot;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-d</span><span class="s2"> %B %Y&quot;</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Nombre total de jours&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">date_end</span> <span class="o">-</span> <span class="n">date_start</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="p">))</span>
            <span class="n">tab1</span><span class="p">,</span> <span class="n">tab2</span><span class="p">,</span> <span class="n">tab3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">tabs</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;üìà Par Ann√©e&quot;</span><span class="p">,</span> <span class="s2">&quot;üìÖ Par Mois&quot;</span><span class="p">,</span> <span class="s2">&quot;üìÜ Par Jour de la Semaine&quot;</span><span class="p">])</span>

            <span class="k">with</span> <span class="n">tab1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution des soumissions par ann√©e&quot;</span><span class="p">)</span>
                <span class="n">fig_year</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">df_year</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Ann√©e&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;√âvolution des soumissions par ann√©e&#39;</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_year</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df_year</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span>
                    <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span> <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">tab2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution des soumissions par mois&quot;</span><span class="p">)</span>
                <span class="n">fig_month</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_month</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nom du Mois&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">,</span>
                                           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution des soumissions par mois&#39;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_month</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df_month</span><span class="p">[[</span><span class="s1">&#39;Nom du Mois&#39;</span><span class="p">,</span> <span class="s1">&#39;Soumissions&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span>
                    <span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span> <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">tab3</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span>
                    <span class="s2">&quot;Distribution des soumissions par jour de la semaine&quot;</span><span class="p">)</span>
                <span class="n">fig_weekday</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_weekday</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nom du Jour&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">,</span>
                                             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution des soumissions par jour de la semaine&#39;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_weekday</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df_weekday</span><span class="p">[[</span><span class="s1">&#39;Nom du Jour&#39;</span><span class="p">,</span> <span class="s1">&#39;Soumissions&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span>
                    <span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Soumissions&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span> <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_submission_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_steps_and_time_analysis">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_steps_and_time_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">display_steps_and_time_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Afficher l&#39;analyse des √©tapes de la recette et du temps de pr√©paration.</span>

<span class="sd">        Cette fonction permet de visualiser diverses statistiques et distributions relatives au nombre d&#39;√©tapes des recettes et √† leur temps de pr√©paration.</span>
<span class="sd">        dans les recettes et leur temps de pr√©paration. Elle cr√©e des graphiques et des tableaux interactifs √† l&#39;aide de Streamlit</span>
<span class="sd">        pour pr√©senter les donn√©es dans un format facilement assimilable.</span>

<span class="sd">        L&#39;analyse comprend</span>
<span class="sd">        - Statistiques sur le nombre d&#39;√©tapes (moyenne, m√©diane, min, max)</span>
<span class="sd">        - Distribution du nombre d&#39;√©tapes entre les recettes</span>
<span class="sd">        - Statistiques relatives au temps (temps de pr√©paration moyen, m√©dian, min, max)</span>
<span class="sd">        - R√©partition des recettes sur diff√©rentes plages horaires</span>
<span class="sd">        - Ventilation d√©taill√©e des plages de temps</span>

<span class="sd">        La fonction g√®re les exceptions potentielles et enregistre toutes les erreurs qui se produisent pendant l&#39;ex√©cution.</span>

<span class="sd">        Param√®tres :</span>
<span class="sd">        Aucun</span>

<span class="sd">        Retourne :</span>
<span class="sd">        Aucun</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">analyze_recipe_complexity</span><span class="p">()</span>
            <span class="n">steps_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;steps_stats&quot;</span><span class="p">]</span>
            <span class="n">time_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;time_stats&quot;</span><span class="p">]</span>
            <span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;üìä Analyse des √âtapes et du Temps&quot;</span><span class="p">)</span>
            <span class="n">tab1</span><span class="p">,</span> <span class="n">tab2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">tabs</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;üö∂ Analyse des √âtapes&quot;</span><span class="p">,</span> <span class="s2">&quot;‚è±Ô∏è Analyse du Temps&quot;</span><span class="p">])</span>
            <span class="k">with</span> <span class="n">tab1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Statistiques des √âtapes&quot;</span><span class="p">)</span>
                <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Moyenne&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;M√©diane&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Minimum&quot;</span><span class="p">,</span> <span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">])</span>
                <span class="k">with</span> <span class="n">col4</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Maximum&quot;</span><span class="p">,</span> <span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>

                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution du nombre d&#39;√©tapes&quot;</span><span class="p">)</span>
                <span class="n">df_steps</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                    <span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">√©tapes&#39;</span><span class="p">,</span> <span class="s1">&#39;Fr√©quence&#39;</span><span class="p">])</span>
                <span class="n">fig_steps</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_steps</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nombre d</span><span class="se">\&#39;</span><span class="s1">√©tapes&#39;</span><span class="p">,</span>
                                           <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Fr√©quence&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution du nombre d</span><span class="se">\&#39;</span><span class="s1">√©tapes&#39;</span><span class="p">)</span>
                <span class="n">fig_steps</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">bargap</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_steps</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span><span class="s2">&quot;Voir les donn√©es d√©taill√©es&quot;</span><span class="p">):</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df_steps</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">tab2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Statistiques Temporelles&quot;</span><span class="p">)</span>
                <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Moyenne&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                              </span><span class="n">time_stats</span><span class="p">[</span><span class="s1">&#39;mean_minutes&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> min&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;M√©diane&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                              </span><span class="n">time_stats</span><span class="p">[</span><span class="s1">&#39;median_minutes&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> min&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Minimum&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time_stats</span><span class="p">[</span><span class="s1">&#39;min_minutes&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> min&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">col4</span><span class="p">:</span>
                    <span class="n">max_hours</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">time_stats</span><span class="p">[</span><span class="s1">&#39;max_minutes&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">60</span>
                    <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Maximum&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_hours</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> heures&quot;</span><span class="p">)</span>

                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Distribution des plages temporelles&quot;</span><span class="p">)</span>
                <span class="n">df_time</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="n">time_stats</span><span class="p">[</span><span class="s1">&#39;time_ranges&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Plage&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">])</span>
                <span class="n">order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0-15min&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;15-30min&#39;</span><span class="p">,</span> <span class="s1">&#39;30-60min&#39;</span><span class="p">,</span> <span class="s1">&#39;1-2h&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;2h&#39;</span><span class="p">]</span>
                <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Plage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
                    <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Plage&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_time</span> <span class="o">=</span> <span class="n">df_time</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Plage&#39;</span><span class="p">)</span>
                <span class="n">fig_time</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df_time</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;Plage&#39;</span><span class="p">,</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;R√©partition des dur√©es&#39;</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">Set3</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_time</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;D√©tails par plage temporelle&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df_time</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">highlight_max</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">highlight_min</span><span class="p">(</span>
                    <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightpink&#39;</span><span class="p">),</span> <span class="n">hide_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">total</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Pourcentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Pourcentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_time</span><span class="p">[</span><span class="s1">&#39;Pourcentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span>

                <span class="n">fig_time_bars</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_time</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Plage&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution des dur√©es&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Pourcentage&#39;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_time_bars</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### üìà Statistiques Globales&quot;</span><span class="p">)</span>
            <span class="n">total_entries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">steps_stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Nombre total d&#39;entr√©es&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">total_entries</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_steps_and_time_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_nutrition_analysis">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_nutrition_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">display_nutrition_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Afficher l&#39;analyse nutritionnelle.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nutrition_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">analyze_nutrition</span><span class="p">()</span>

            <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Filtres Nutritionnels&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Analyse des Donn√©es Nutritionnelles&quot;</span><span class="p">)</span>
            <span class="n">nutrient</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&quot;S√©lectionner un nutriment √† analyser&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">nutrition_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">format_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
            <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Moyenne&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                    </span><span class="n">nutrition_data</span><span class="p">[</span><span class="n">nutrient</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;M√©diane&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                    </span><span class="n">nutrition_data</span><span class="p">[</span><span class="n">nutrient</span><span class="p">][</span><span class="s1">&#39;median&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col3</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Minimum&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                    </span><span class="n">nutrition_data</span><span class="p">[</span><span class="n">nutrient</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">col4</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;Maximum&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span>
<span class="w">                    </span><span class="n">nutrition_data</span><span class="p">[</span><span class="n">nutrient</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">nutrients_stats</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">nut</span><span class="p">,</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">nutrition_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">nutrients_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;Nutriment&#39;</span><span class="p">:</span> <span class="n">nut</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
                    <span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;quartiles&#39;</span><span class="p">][</span><span class="mf">0.25</span><span class="p">],</span>
                    <span class="s1">&#39;M√©diane&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;quartiles&#39;</span><span class="p">][</span><span class="mf">0.5</span><span class="p">],</span>
                    <span class="s1">&#39;Q3&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;quartiles&#39;</span><span class="p">][</span><span class="mf">0.75</span><span class="p">],</span>
                    <span class="s1">&#39;Moyenne&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
                <span class="p">})</span>

            <span class="n">df_nutrients</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">nutrients_stats</span><span class="p">)</span>
            <span class="n">fig_box</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">nut</span> <span class="ow">in</span> <span class="n">df_nutrients</span><span class="p">[</span><span class="s1">&#39;Nutriment&#39;</span><span class="p">]:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">df_nutrients</span><span class="p">[</span><span class="n">df_nutrients</span><span class="p">[</span><span class="s1">&#39;Nutriment&#39;</span><span class="p">]</span>
                                   <span class="o">==</span> <span class="n">nut</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">fig_box</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">nut</span><span class="p">,</span>
                    <span class="n">q1</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]],</span>
                    <span class="n">median</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;M√©diane&#39;</span><span class="p">]],</span>
                    <span class="n">q3</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Q3&#39;</span><span class="p">]],</span>
                    <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Moyenne&#39;</span><span class="p">]],</span>
                    <span class="n">lowerfence</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">upperfence</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Moyenne&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">))</span>

            <span class="n">fig_box</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Comparaison des distributions des nutriments&#39;</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">plotly_chart</span><span class="p">(</span><span class="n">fig_box</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_nutrition_analysis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_data_structures">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_data_structures">[docs]</a>
    <span class="k">def</span> <span class="nf">display_data_structures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns_to_show</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">search_term</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Affiche les structures de donn√©es avec un filtrage optionnel.</span>

<span class="sd">        Args :</span>
<span class="sd">            columns_to_show (Facultatif[liste[str]]) : Les colonnes √† afficher. La valeur par d√©faut est None.</span>
<span class="sd">            search_term (Facultatif[str]) : Le terme de recherche pour filtrer les donn√©es. </span>
<span class="sd">        La valeur par d√©faut est None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">columns_to_show</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">columns_to_show</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span>
            <span class="n">number_of_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
                <span class="s2">&quot;S√©lectionnez le nombre d&#39;√©l√©ments √† afficher :&quot;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
                <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;selectbox_dist&#39;</span>
            <span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Afficharger des </span><span class="si">{</span>
<span class="w">                         </span><span class="n">number_of_rows</span><span class="si">}</span><span class="s1"> premiers elements du dataset&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">search_term</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span>
                    <span class="n">search_term</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="n">columns_to_show</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">columns_to_show</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">))</span>

            <span class="n">colonnes_preview</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span>
                <span class="s2">&quot;Afficher la description des colonnes&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colonnes_preview</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ce tableau fournit une description d√©taill√©e des colonnes utilis√©es dans la base de donn√©es des recettes. Chaque colonne contient des informations sp√©cifiques permettant d‚Äôidentifier et de d√©crire les recettes et leurs attributs.&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
                <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">recipe_columns_description</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_data_structures: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_anomalies_values">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_anomalies_values">[docs]</a>
    <span class="k">def</span> <span class="nf">display_anomalies_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Afficher les valeurs d&#39;anomalies dans le jeu de donn√©es.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">colonnes_preview</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">checkbox</span><span class="p">(</span>
                <span class="s2">&quot;Afficher les valeurs ab√©rantes&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colonnes_preview</span><span class="p">:</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Valeurs manquantes&quot;</span><span class="p">)</span>
                <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">annomalis</span><span class="p">[</span><span class="s2">&quot;missing_values&quot;</span><span class="p">])</span>
                <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;valeurs aberrantes std&quot;</span><span class="p">)</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">annomalis</span><span class="p">[</span><span class="s2">&quot;std_outliers&quot;</span><span class="p">])</span>
                <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;score valeurs aberrantes&quot;</span><span class="p">)</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">annomalis</span><span class="p">[</span><span class="s2">&quot;z_score_outliers&quot;</span><span class="p">])</span>
                <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
                <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Infos sur les colonnes&quot;</span><span class="p">)</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">annomalis</span><span class="p">[</span><span class="s2">&quot;column_info&quot;</span><span class="p">])</span>
                <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_anomalies_values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.analyze_ingredients">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.analyze_ingredients">[docs]</a>
    <span class="k">def</span> <span class="nf">analyze_ingredients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyser et afficher les ingr√©dients les plus fr√©quents dans les recettes.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ingredient_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ingredients&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="nb">eval</span><span class="p">)</span> <span class="k">if</span> <span class="n">DEPLOIEMENT_SITE</span> <span class="o">!=</span> <span class="s2">&quot;ONLINE&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">get_recipe_data</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ingredients&quot;</span><span class="p">]</span>
            <span class="n">flat_ingredients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">item</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">ingredient_sample</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
            <span class="n">ingredient_freq</span><span class="p">:</span> <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">flat_ingredients</span><span class="p">)</span>
            <span class="n">ingredients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">frequences</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">ingredient_freq</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">ingredients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                <span class="n">frequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

            <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;Ingr√©dient&quot;</span><span class="p">:</span> <span class="n">ingredients</span><span class="p">,</span> <span class="s2">&quot;Frequence&quot;</span><span class="p">:</span> <span class="n">frequences</span><span class="p">})</span>
            <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;10 ingr√©dients les plus frequents dans les recettes&quot;</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">ingredient_freq</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="n">wordcloud_option</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;series&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;wordCloud&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">}]}</span>
            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;### Nuage de mots&quot;</span><span class="p">)</span>
            <span class="n">st_echarts</span><span class="p">(</span><span class="n">wordcloud_option</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in analyze_ingredients: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.display_tab">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.display_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">display_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Affiche les principaux onglets de l&#39;application.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create tabs with icons</span>
            <span class="n">tabs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">tabs</span><span class="p">([</span>
                <span class="s2">&quot;üè† Accueil&quot;</span><span class="p">,</span>
                <span class="s2">&quot;üìä Analyse&quot;</span><span class="p">,</span>
                <span class="s2">&quot;üìà Prediction&quot;</span>
            <span class="p">])</span>
            <span class="k">with</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_tab</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analysis_tab</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recommandation_page</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in display_tab: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DisplayManager.recommandation_page">
<a class="viewcode-back" href="../../../../pages/recipes/Analyse_recipe.html#src.pages.recipes.Analyse_recipes.DisplayManager.recommandation_page">[docs]</a>
    <span class="k">def</span> <span class="nf">recommandation_page</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Affichez la page de recommandation avec des recommandations de recettes personnalis√©es.&quot;&quot;&quot;</span>

        <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
            <span class="s1">&#39;&lt;div class=&quot;sidebar-title&quot;&gt;üçΩÔ∏è Recipe Intelligence&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
            <span class="s1">&#39;&lt;h1 class=&quot;main-title&quot;&gt;üç≤ Recommandations Personnalis√©es&lt;/h1&gt;&#39;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># if &quot;selected_recipe_id&quot; in st.session_state:</span>
        <span class="c1"># print(st.session_state.selected_recipe_id)</span>
        <span class="n">list_recommender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">recipes_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[:</span><span class="mi">15</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;selected_recipe_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_recipe_id</span> <span class="o">=</span> <span class="n">list_recommender</span><span class="p">[</span>
                <span class="mi">2</span><span class="p">]</span>
        <span class="n">selected_recipe_id</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
            <span class="s2">&quot;Choisissez une recette de base&quot;</span><span class="p">,</span>
            <span class="n">list_recommender</span><span class="p">,</span>
            <span class="n">list_recommender</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_recipe_id</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_recipe_id</span> <span class="o">=</span> <span class="n">selected_recipe_id</span>
        <span class="c1"># print(recommender.recipes_df[recommender.recipes_df[&#39;id&#39;]</span>
        <span class="c1">#                           == st.session_state.selected_recipe_id])</span>
        <span class="n">selected_recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">recipes_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">recipes_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
                                                      <span class="o">==</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">selected_recipe_id</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div class=&quot;recommendation-card&quot;&gt;</span>
<span class="s2">            &lt;h2 class=&quot;recipe-detail&quot;&gt;</span><span class="si">{</span><span class="n">selected_recipe</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/h2&gt;</span>
<span class="s2">            &lt;div class=&quot;recipe-detail&quot;&gt;</span>
<span class="s2">                &lt;p&gt;‚è∞ &lt;strong&gt;Dur√©e :&lt;/strong&gt; </span><span class="si">{</span><span class="n">selected_recipe</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> minutes&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;üìã &lt;strong&gt;Nombre d&#39;√©tapes :&lt;/strong&gt; </span><span class="si">{</span><span class="n">selected_recipe</span><span class="p">[</span><span class="s1">&#39;n_steps&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&lt;h3&gt;ü•¨ Ingr√©dients&lt;/h3&gt;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ingredients</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span>
            <span class="n">selected_recipe</span><span class="p">[</span><span class="s1">&#39;ingredients&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">DEPLOIEMENT_SITE</span> <span class="o">!=</span> <span class="s2">&quot;ONLINE&quot;</span> <span class="k">else</span> <span class="n">selected_recipe</span><span class="p">[</span><span class="s1">&#39;ingredients&#39;</span><span class="p">]</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;&lt;div class=&quot;ingredient-list&quot;&gt;</span><span class="si">{</span><span class="s2">&quot; ‚Ä¢ &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ingredients</span><span class="p">)</span><span class="si">}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;&lt;h3&gt;üîç Recommandations Similaires&lt;/h3&gt;&quot;</span><span class="p">,</span>
                    <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">recommendations</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">content_based_recommendations</span><span class="p">(</span>
            <span class="n">selected_recipe_id</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="mi">3</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">recommendations</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;div class=&quot;recommendation-card&quot;&gt;</span>
<span class="s2">                &lt;h4&gt;</span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/h4&gt;</span>
<span class="s2">                &lt;p&gt;‚è∞ &lt;strong&gt;Dur√©e :&lt;/strong&gt; </span><span class="si">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> minutes&lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;ü•ò &lt;strong&gt;Ingr√©dients :&lt;/strong&gt; </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;ingredients&#39;</span><span class="p">]))</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">DEPLOIEMENT_SITE</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;ONLINE&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;ingredients&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
</div>



</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2024, Paul, Alexandre, Alexandre, Julian.</p>
  </div>

  Compil√© avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">th√®me</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>